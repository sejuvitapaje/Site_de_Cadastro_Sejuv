<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Cadastro - Unificado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Firebase App (o core do Firebase) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <!-- Firebase Auth -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Página de Login -->
    <div id="loginPage" class="page active-page">
        <div class="container">
            <div class="login-container">
                <div class="center logo">
                    <i class="fas fa-database logo-icon"></i>
                    <h1 style="color: var(--azul);">Sistema de Cadastro</h1>
                </div>
                <p class="center" style="margin-bottom: 25px; color: #666;">Área restrita para usuários autorizados</p>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail"><i class="fas fa-envelope"></i> Email:</label>
                        <input type="email" id="loginEmail" placeholder="Seu email" required>
                    </div>
                    <div class="form-group">
                        <label for="loginSenha"><i class="fas fa-lock"></i> Senha:</label>
                        <input type="password" id="loginSenha" placeholder="Sua senha" required>
                    </div>
                    <div class="form-group center">
                        <button type="submit"><i class="fas fa-sign-in-alt"></i> Entrar</button>
                    </div>
                </form>
                
                <div class="info-box">
                    <p><strong><i class="fas fa-info-circle"></i> Acesso restrito</strong></p>
                    <p>Entre em contato com o administrador para obter acesso ao sistema.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Página Dashboard -->
    <div id="dashboardPage" class="page">
        <div class="container">
            <header>
                <div>
                    <h1><i class="fas fa-home"></i> Dashboard</h1>
                    <div class="user-badge">
                        <i class="fas fa-user"></i>
                        <span id="currentUser"></span>
                    </div>
                </div>
                <nav>
                    <a href="#" onclick="navigateTo('dadosPage')"><i class="fas fa-list"></i> Gerenciar Dados</a>
                    <a href="#" onclick="navigateTo('todosDadosPage')"><i class="fas fa-table"></i> Todos os Dados</a>
                    <a href="#" onclick="navigateTo('adminPage')"><i class="fas fa-database"></i> Backup</a>
                    <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sair</a>
                </nav>
            </header>
            
            <div class="content">
                <div class="card">
                    <h2>Bem-vindo ao Sistema de Cadastro</h2>
                    <p>Utilize o menu acima para navegar entre as funcionalidades do sistema.</p>
                    
                    <div class="admin-panel">
                        <div class="admin-card" onclick="navigateTo('dadosPage')">
                            <h2><i class="fas fa-list"></i> Gerenciar Dados</h2>
                            <p>Gerencie todos os dados do sistema</p>
                            <div class="stats" id="dadosCount">0 registros</div>
                        </div>
                        
                        <div class="admin-card" onclick="navigateTo('todosDadosPage')">
                            <h2><i class="fas fa-table"></i> Todos os Dados</h2>
                            <p>Visualize todos os dados cadastrados</p>
                            <div class="stats" id="todosDadosCount">0 registros</div>
                        </div>
                        
                        <div class="admin-card" onclick="navigateTo('adminPage')">
                            <h2><i class="fas fa-database"></i> Backup</h2>
                            <p>Faça backup e restauração dos dados</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Página Dados Cadastrados -->
    <div id="dadosPage" class="page">
        <div class="container">
            <header>
                <div>
                    <h1><i class="fas fa-list"></i> Gerenciar Dados</h1>
                    <div class="user-badge">
                        <i class="fas fa-user"></i>
                        <span id="currentUserDados"></span>
                    </div>
                </div>
                <nav>
                    <a href="#" onclick="navigateTo('dashboardPage')"><i class="fas fa-home"></i> Dashboard</a>
                    <a href="#" onclick="navigateTo('todosDadosPage')"><i class="fas fa-table"></i> Todos os Dados</a>
                    <a href="#" onclick="navigateTo('adminPage')"><i class="fas fa-database"></i> Backup</a>
                    <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sair</a>
                </nav>
            </header>
            
            <div class="content">
                <div class="card">
                    <h2>Adicionar Novo Local</h2>
                    <form id="cadastroLocalForm">
                        <div class="form-group">
                            <label for="nomeLocal">Nome do Local:</label>
                            <input type="text" id="nomeLocal" required placeholder="Digite o nome do local (ex: Quadra da Escola X)">
                        </div>
                        
                        <div class="form-group">
                            <label for="enderecoLocal">Endereço:</label>
                            <input type="text" id="enderecoLocal" required placeholder="Digite o endereço completo">
                        </div>
                        
                        <div class="form-group">
                            <label for="responsavelLocal">Responsável pelo Local:</label>
                            <input type="text" id="responsavelLocal" required placeholder="Nome do responsável">
                        </div>
                        
                        <div class="form-group">
                            <label for="contatoLocal">Contato do Responsável:</label>
                            <textarea id="contatoLocal" rows="3" placeholder="Telefone, email ou outras informações de contato"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="capacidadeLocal">Capacidade:</label>
                            <input type="number" id="capacidadeLocal" placeholder="Número de pessoas (opcional)">
                        </div>
                        
                        <button type="submit"><i class="fas fa-plus"></i> Adicionar Local</button>
                    </form>
                    
                    <div id="mensagem"></div>
                </div>

                <div class="card">
                    <h2>Adicionar Evento</h2>
                    <form id="cadastroEventoForm">
                        <div class="form-group">
                            <label for="localEvento">Selecionar Local:</label>
                            <select id="localEvento" required>
                                <option value="">Selecione um local</option>
                                <!-- Opções serão preenchidas via JavaScript -->
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="escolaEvento">Nome da Escola/Grupo:</label>
                            <input type="text" id="escolaEvento" required placeholder="Digite o nome da escola ou grupo">
                        </div>
                        
                        <div class="form-group">
                            <label for="diaSemanaEvento">Dia da Semana:</label>
                            <select id="diaSemanaEvento" required>
                                <option value="">Selecione o dia</option>
                                <option value="Segunda-feira">Segunda-feira</option>
                                <option value="Terça-feira">Terça-feira</option>
                                <option value="Quarta-feira">Quarta-feira</option>
                                <option value="Quinta-feira">Quinta-feira</option>
                                <option value="Sexta-feira">Sexta-feira</option>
                                <option value="Sábado">Sábado</option>
                                <option value="Domingo">Domingo</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="horarioInicio">Horário de Início:</label>
                            <input type="time" id="horarioInicio" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="horarioFim">Horário de Término:</label>
                            <input type="time" id="horarioFim" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="responsavelEvento">Responsável pelo Evento:</label>
                            <input type="text" id="responsavelEvento" required placeholder="Nome do responsável">
                        </div>
                        
                        <div class="form-group">
                            <label for="contatoEvento">Contato do Responsável:</label>
                            <textarea id="contatoEvento" rows="3" placeholder="Telefone, email ou outras informações de contato"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="observacoesEvento">Observações:</label>
                            <textarea id="observacoesEvento" rows="3" placeholder="Informações adicionais (opcional)"></textarea>
                        </div>
                        
                        <button type="submit"><i class="fas fa-plus"></i> Adicionar Evento</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Página Todos os Dados Cadastrados -->
    <div id="todosDadosPage" class="page">
        <div class="container">
            <header>
                <div>
                    <h1><i class="fas fa-table"></i> Todos os Dados Cadastrados</h1>
                    <div class="user-badge">
                        <i class="fas fa-user"></i>
                        <span id="currentUserTodosDados"></span>
                    </div>
                </div>
                <nav>
                    <a href="#" onclick="navigateTo('dashboardPage')"><i class="fas fa-home"></i> Dashboard</a>
                    <a href="#" onclick="navigateTo('dadosPage')"><i class="fas fa-list"></i> Gerenciar Dados</a>
                    <a href="#" onclick="navigateTo('adminPage')"><i class="fas fa-database"></i> Backup</a>
                    <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sair</a>
                </nav>
            </header>
            
            <div class="content">
                <div class="card">
                    <h2>Todos os Dados Cadastrados</h2>
                    
                    <div class="filter-section">
                        <h3>Filtrar Dados</h3>
                        <div class="search-box">
                            <input type="text" id="pesquisaDados" placeholder="Pesquisar em todos os dados..." onkeyup="filtrarDados()">
                            <button onclick="limparPesquisaDados()"><i class="fas fa-times"></i> Limpar</button>
                        </div>
                        
                        <div class="form-group">
                            <label for="filtroTipoDados">Tipo de Dados:</label>
                            <select id="filtroTipoDados" onchange="filtrarDados()">
                                <option value="todos">Todos os dados</option>
                                <option value="locais">Apenas locais</option>
                                <option value="eventos">Apenas eventos</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="tabelaDados">
                            <thead>
                                <tr>
                                    <th width="50">#</th>
                                    <th>Tipo</th>
                                    <th>Nome/Local</th>
                                    <th>Detalhes</th>
                                    <th>Responsável</th>
                                    <th>Data/Hora</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Os dados serão inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Página Admin -->
    <div id="adminPage" class="page">
        <div class="container">
            <header>
                <div>
                    <h1><i class="fas fa-database"></i> Administração - Backup de Dados</h1>
                    <div class="user-badge">
                        <i class="fas fa-user"></i>
                        <span id="currentUserAdmin"></span>
                    </div>
                </div>
                <nav>
                    <a href="#" onclick="navigateTo('dashboardPage')"><i class="fas fa-home"></i> Dashboard</a>
                    <a href="#" onclick="navigateTo('dadosPage')"><i class="fas fa-list"></i> Gerenciar Dados</a>
                    <a href="#" onclick="navigateTo('todosDadosPage')"><i class="fas fa-table"></i> Todos os Dados</a>
                    <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sair</a>
                </nav>
            </header>

            <div class="content">
                <div class="card">
                    <div class="info-box">
                        <p><strong><i class="fas fa-exclamation-triangle"></i> Backup é essencial!</strong> Faça backup regularmente para garantir que não perca seus dados.</p>
                    </div>
                </div>

                <div class="admin-panel">
                    <div class="admin-card">
                        <h2><i class="fas fa-file-export"></i> Criar Backup (JSON)</h2>
                        <p>Salva todos os dados em formato JSON para backup</p>
                        <div class="form-group">
                            <label for="backupName">Nome do arquivo:</label>
                            <input type="text" id="backupName" placeholder="Nome do backup" value="backup-dados">
                        </div>
                        <button onclick="fazerBackupJSON()" class="btn-backup"><i class="fas fa-download"></i> Criar Backup JSON</button>
                    </div>

                    <div class="admin-card">
                        <h2><i class="fas fa-file-excel"></i> Exportar para Excel</h2>
                        <p>Exporta todos os registros para planilha Excel (XLSX)</p>
                        <button onclick="exportarParaExcel()" class="btn-export"><i class="fas fa-file-export"></i> Exportar para Excel</button>
                    </div>

                    <div class="admin-card">
                        <h2><i class="fas fa-file-import"></i> Restaurar Backup</h2>
                        <p>Restaura os dados a partir de um arquivo JSON</p>
                        <div class="form-group">
                            <label for="restoreFile">Selecionar arquivo JSON:</label>
                            <input type="file" id="restoreFile" accept=".json">
                        </div>
                        <button onclick="restaurarBackup()" class="btn-info"><i class="fas fa-upload"></i> Restaurar Dados</button>
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-chart-bar"></i> Estatísticas do Sistema</h2>
                    <div id="estatisticas">
                        <p>Carregando estatísticas...</p>
                    </div>
                    
                    <div id="backupStatus" class="info-box">
                        <p><strong>Status de backup:</strong> Nenhum backup realizado recentemente.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para detalhes -->
    <div id="detalhesModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitulo">Detalhes</h2>
            
            <div class="search-box" style="margin-bottom: 15px;">
                <input type="text" id="pesquisaEventosModal" placeholder="Pesquisar eventos..." onkeyup="filtrarEventosModal()">
                <button onclick="limparPesquisaEventosModal()"><i class="fas fa-times"></i> Limpar</button>
            </div>
            
            <div id="modalConteudo"></div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>